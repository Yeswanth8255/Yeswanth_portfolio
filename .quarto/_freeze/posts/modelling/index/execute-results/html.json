{
  "hash": "baab404ee7d2999aa3f1394f9f3ed175",
  "result": {
    "markdown": "---\ntitle: \"Support Vector Machine (SVM) model\"\nauthor: \"Yeswanth Chitirala\"\ndate: \"2024-01-03\"\ncategories: [news, code, analysis]\nimage: \"image.jpg\"\n---\n\n\n## Introduction\n\nIn this R code, we are working towards the future goal of building and assessing a machine learning model, specifically a Support Vector Machine (SVM). The dataset, generated randomly, includes predictor variables (X1, X2, and X3) and a response variable (Y). Our objective is to predict Y based on the given predictors using an SVM algorithm. We will proceed by splitting the dataset into training and testing sets, allocating 80% for model training and reserving 20% for future evaluation. In the next steps, we will train the SVM model on the training data, aiming to capture underlying patterns for accurate predictions. Subsequently, we will utilize the trained model to make predictions on the test set. For a comprehensive assessment, we plan to evaluate the model's performance, calculating metrics such as accuracy and visualizing results through a confusion matrix and scatter plot. The intention is to gain insights into the model's predictive capabilities and potential areas for improvement in future iterations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load required libraries\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(caret)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: lattice\n```\n:::\n\n```{.r .cell-code}\nlibrary(plotly)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'plotly'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:ggplot2':\n\n    last_plot\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:graphics':\n\n    layout\n```\n:::\n\n```{.r .cell-code}\nlibrary(e1071) \n\n# Set seed for reproducibility\nset.seed(123)\n\n# Generate a random dataframe\nn <- 100\nrandom_df <- data.frame(\n  X1 = rnorm(n),\n  X2 = rnorm(n),\n  X3 = rnorm(n)\n)\n\n# Add the Y column based on X1, X2, and X3\nrandom_df$Y <- 2 * random_df$X1 - 3 * random_df$X2 + 0.5 * random_df$X3 + rnorm(n)\n\n# Display the first few rows of the dataframe\nprint(\"Random Dataframe:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Random Dataframe:\"\n```\n:::\n\n```{.r .cell-code}\nprint(head(random_df))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           X1          X2         X3          Y\n1 -0.56047565 -0.71040656  2.1988103  1.3944314\n2 -0.23017749  0.25688371  1.3124130 -1.3274886\n3  1.55870831 -0.24669188 -0.2651451  2.7863810\n4  0.07050839 -0.34754260  0.5431941  0.4027283\n5  0.12928774 -0.95161857 -0.4143399  2.4691017\n6  1.71506499 -0.04502772 -0.4762469  3.6582689\n```\n:::\n:::\n\n## Modelling \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Split the data into training and testing sets\ntrainIndex <- createDataPartition(random_df$Y, p = 0.8, list = FALSE)\ntrain_data <- random_df[trainIndex, ]\ntest_data <- random_df[-trainIndex, ]\n\n# Train a Support Vector Machine (SVM) model\nsvm_model <- svm(Y ~ ., data = train_data)\n\n# Make predictions on the test set\npredictions <- predict(svm_model, newdata = test_data)\n\n# Evaluate the model\nconf_matrix <- table(Actual = test_data$Y, Predicted = predictions)\naccuracy <- sum(diag(conf_matrix)) / sum(conf_matrix)\n\n# Print detailed accuracy metrics\nprint(\"Confusion Matrix:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Confusion Matrix:\"\n```\n:::\n\n```{.r .cell-code}\nprint(conf_matrix)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                    Predicted\nActual               -5.65664381921355 -3.18108018354608 -3.16183221893515\n  -10.0854979973896                  0                 0                 0\n  -5.65490828406853                  1                 0                 0\n  -4.63790690416361                  0                 0                 1\n  -3.45919518577466                  0                 1                 0\n  -2.46051642793663                  0                 0                 0\n  -1.4855185126181                   0                 0                 0\n  -1.02943777752725                  0                 0                 0\n  -0.747187507913909                 0                 0                 0\n  -0.703916425855438                 0                 0                 0\n  -0.680630472595762                 0                 0                 0\n  1.774013335589                     0                 0                 0\n  2.39583698699594                   0                 0                 0\n  2.50335904663394                   0                 0                 0\n  2.57684106175132                   0                 0                 0\n  2.697448829756                     0                 0                 0\n  3.36063285521033                   0                 0                 0\n  3.65826887384452                   0                 0                 0\n  3.93357553214689                   0                 0                 0\n  5.01812398988059                   0                 0                 0\n  5.92422000001226                   0                 0                 0\n                    Predicted\nActual               -2.39426479954742 -2.02994865465174 -1.49207304124759\n  -10.0854979973896                  0                 0                 0\n  -5.65490828406853                  0                 0                 0\n  -4.63790690416361                  0                 0                 0\n  -3.45919518577466                  0                 0                 0\n  -2.46051642793663                  0                 1                 0\n  -1.4855185126181                   0                 0                 0\n  -1.02943777752725                  1                 0                 0\n  -0.747187507913909                 0                 0                 0\n  -0.703916425855438                 0                 0                 1\n  -0.680630472595762                 0                 0                 0\n  1.774013335589                     0                 0                 0\n  2.39583698699594                   0                 0                 0\n  2.50335904663394                   0                 0                 0\n  2.57684106175132                   0                 0                 0\n  2.697448829756                     0                 0                 0\n  3.36063285521033                   0                 0                 0\n  3.65826887384452                   0                 0                 0\n  3.93357553214689                   0                 0                 0\n  5.01812398988059                   0                 0                 0\n  5.92422000001226                   0                 0                 0\n                    Predicted\nActual               -0.774026837236475 -0.541667282156556 -0.397893190050167\n  -10.0854979973896                   0                  1                  0\n  -5.65490828406853                   0                  0                  0\n  -4.63790690416361                   0                  0                  0\n  -3.45919518577466                   0                  0                  0\n  -2.46051642793663                   0                  0                  0\n  -1.4855185126181                    0                  0                  1\n  -1.02943777752725                   0                  0                  0\n  -0.747187507913909                  1                  0                  0\n  -0.703916425855438                  0                  0                  0\n  -0.680630472595762                  0                  0                  0\n  1.774013335589                      0                  0                  0\n  2.39583698699594                    0                  0                  0\n  2.50335904663394                    0                  0                  0\n  2.57684106175132                    0                  0                  0\n  2.697448829756                      0                  0                  0\n  3.36063285521033                    0                  0                  0\n  3.65826887384452                    0                  0                  0\n  3.93357553214689                    0                  0                  0\n  5.01812398988059                    0                  0                  0\n  5.92422000001226                    0                  0                  0\n                    Predicted\nActual               -0.167020631615369 0.325630584431048 0.934884433347682\n  -10.0854979973896                   0                 0                 0\n  -5.65490828406853                   0                 0                 0\n  -4.63790690416361                   0                 0                 0\n  -3.45919518577466                   0                 0                 0\n  -2.46051642793663                   0                 0                 0\n  -1.4855185126181                    0                 0                 0\n  -1.02943777752725                   0                 0                 0\n  -0.747187507913909                  0                 0                 0\n  -0.703916425855438                  0                 0                 0\n  -0.680630472595762                  0                 0                 1\n  1.774013335589                      0                 0                 0\n  2.39583698699594                    0                 0                 0\n  2.50335904663394                    1                 0                 0\n  2.57684106175132                    0                 0                 0\n  2.697448829756                      0                 0                 0\n  3.36063285521033                    0                 1                 0\n  3.65826887384452                    0                 0                 0\n  3.93357553214689                    0                 0                 0\n  5.01812398988059                    0                 0                 0\n  5.92422000001226                    0                 0                 0\n                    Predicted\nActual               1.15376991391586 2.10950645904277 2.59208250219426\n  -10.0854979973896                 0                0                0\n  -5.65490828406853                 0                0                0\n  -4.63790690416361                 0                0                0\n  -3.45919518577466                 0                0                0\n  -2.46051642793663                 0                0                0\n  -1.4855185126181                  0                0                0\n  -1.02943777752725                 0                0                0\n  -0.747187507913909                0                0                0\n  -0.703916425855438                0                0                0\n  -0.680630472595762                0                0                0\n  1.774013335589                    0                0                0\n  2.39583698699594                  1                0                0\n  2.50335904663394                  0                0                0\n  2.57684106175132                  0                1                0\n  2.697448829756                    0                0                0\n  3.36063285521033                  0                0                0\n  3.65826887384452                  0                0                0\n  3.93357553214689                  0                0                1\n  5.01812398988059                  0                0                0\n  5.92422000001226                  0                0                0\n                    Predicted\nActual               3.12903569705979 3.24842717786761 3.61054373113523\n  -10.0854979973896                 0                0                0\n  -5.65490828406853                 0                0                0\n  -4.63790690416361                 0                0                0\n  -3.45919518577466                 0                0                0\n  -2.46051642793663                 0                0                0\n  -1.4855185126181                  0                0                0\n  -1.02943777752725                 0                0                0\n  -0.747187507913909                0                0                0\n  -0.703916425855438                0                0                0\n  -0.680630472595762                0                0                0\n  1.774013335589                    0                1                0\n  2.39583698699594                  0                0                0\n  2.50335904663394                  0                0                0\n  2.57684106175132                  0                0                0\n  2.697448829756                    0                0                0\n  3.36063285521033                  0                0                0\n  3.65826887384452                  1                0                0\n  3.93357553214689                  0                0                0\n  5.01812398988059                  0                0                1\n  5.92422000001226                  0                0                0\n                    Predicted\nActual               3.84661973754848 5.58376808649549\n  -10.0854979973896                 0                0\n  -5.65490828406853                 0                0\n  -4.63790690416361                 0                0\n  -3.45919518577466                 0                0\n  -2.46051642793663                 0                0\n  -1.4855185126181                  0                0\n  -1.02943777752725                 0                0\n  -0.747187507913909                0                0\n  -0.703916425855438                0                0\n  -0.680630472595762                0                0\n  1.774013335589                    0                0\n  2.39583698699594                  0                0\n  2.50335904663394                  0                0\n  2.57684106175132                  0                0\n  2.697448829756                    1                0\n  3.36063285521033                  0                0\n  3.65826887384452                  0                0\n  3.93357553214689                  0                0\n  5.01812398988059                  0                0\n  5.92422000001226                  0                1\n```\n:::\n\n```{.r .cell-code}\nprint(paste(\"Accuracy:\", round(accuracy, 4)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Accuracy: 0.2\"\n```\n:::\n\n```{.r .cell-code}\n# Visualize the confusion matrix\nplot_conf_matrix <- plot_ly(\n  x = rownames(conf_matrix),\n  y = colnames(conf_matrix),\n  z = as.matrix(conf_matrix),\n  type = \"heatmap\",\n  colorscale = \"Viridis\",\n  showscale = TRUE\n) %>%\n  layout(title = \"Confusion Matrix\",\n         xaxis = list(title = \"Predicted\"),\n         yaxis = list(title = \"Actual\"))\n\n# Print the confusion matrix plot\nprint(plot_conf_matrix)\n```\n:::\n\n# RESULTS\n\nThe output \"Accuracy: 0.25\" suggests that the Support Vector Machine (SVM) model applied to the features X1, X2, ZND, and X3 has an accuracy of 25%. This means that the model's predictions align with the actual outcomes only 25% of the time. Such a low accuracy score indicates that the model might not be performing well on the given data or that there may be room for improvement in the model's configuration, feature selection, or data preprocessing steps. Further analysis and potential adjustments to the model are recommended to enhance its predictive performance.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}